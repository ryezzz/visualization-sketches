{"version":3,"file":"component---src-pages-childhood-diary-swarm-scroll-drawing-js-5f6c9500156481098999.js","mappings":"6NAwJA,UApI+B,SAAC,GAAc,IACtCA,EADqC,EAAXC,KACNC,WAAWC,MAAM,GAAGC,KAAKC,MAEnD,GAAsDC,EAAAA,EAAAA,UAAS,MAAxDC,EAAP,KAA4BC,EAA5B,KACA,GAAoCF,EAAAA,EAAAA,WAClCG,EAAAA,EAAAA,KAAcC,OAAOC,iBAAmB,GADnCC,EAAP,KAAmBC,EAAnB,KAGA,GAAwCP,EAAAA,EAAAA,WACtCG,EAAAA,EAAAA,KAAcC,OAAOI,WAAa,GAD7BC,EAAP,KAAqBC,EAArB,KAGA,GAA0CV,EAAAA,EAAAA,WACxCG,EAAAA,EAAAA,KAAcC,OAAOO,YAAc,GAD9BC,EAAP,KAAsBC,EAAtB,KAsBA,IAAMC,EAAc,CAAC,OAAQ,QAAS,QAIhCC,GAAWC,EAAAA,EAAAA,QAAO,IAwBxB,OArBED,EAASE,QAAUH,EAAYI,KAAI,SAACC,EAASC,GAAV,uBAAiBL,EAASE,QAAQG,UAAlC,SAAwCC,EAAAA,EAAAA,gBAI7EC,EAAAA,WAAgB,YAGVnB,EAAAA,EAAAA,OACFO,EAAgBN,OAAOI,YACvBK,EAAiBT,OAAOO,aACxBJ,EAAcH,OAAOC,kBACrBD,OAAOmB,SAAW,WAChBb,EAAgBN,OAAOI,YACvBK,EAAiBT,OAAOO,aACxBJ,EAAcH,OAAOC,sBAGxB,CAACI,EAAcH,KAIE,KAAhBH,EAAAA,EAAAA,KACK,iCAKP,uBAAKqB,UAAU,gCACb,2BAEE,gBAAC,IAAD,CACEA,UAAW,sDACXC,OAAwB,IAAhBb,EACRc,MAAsB,GAAfjB,EACPkB,WAAWC,EAAAA,EAAAA,IAAgBlC,GAC3BmC,cAAeA,EAAAA,EACfC,eACEC,EAAAA,EAAAA,IAA0B9B,GAAqB+B,eAEjDC,eAAe,mBACfC,UAAWjC,EACXkC,OAAQ,GACRC,WAA2B,GAAf3B,EACZ4B,UAA2B,GAAhBzB,EACXN,WAAYA,IAEd,uBAAKkB,UAAU,iDAIb,gBAAC,IAAD,CAAWc,UAAW,EAAGC,OAAQ,GAAIC,YA3EzB,SAACC,EAAUC,GAC7BxC,EAAuBuC,EAAS9C,OA0EqCgD,OAAO,GAErE7B,EAAYI,KAAI,SAAC0B,EAAcxB,GAAf,OACb,gBAAC,IAAD,CAAMzB,KAAMiD,GACV,uBACEC,IAAKzB,EACL0B,IAAK/B,EAASE,QAAQG,GACtB2B,MAAO,CACLC,QAAS/C,IAAwB2C,EAAe,EAAI,IAEtDK,MAAM,iCAEN,uBAAKC,GAAIjD,EAAsBmB,EAAM2B,MAAO,CAC1CC,QAAgD,GAC/CxB,UAAU,oBAAoBsB,IAAK/B,EAASE,QAAQG,IAFvD,KAE6DW,EAAAA,EAAAA,IAA0Ba,GAAcO","sources":["webpack://visualization-sketches/./src/pages/childhood-diary-swarm-scroll-drawing.js"],"sourcesContent":["import React, { useEffect, useRef, createRef, useState } from \"react\";\nimport {ScrollSwarmDrawing} from \"../components/ScrollySwarm\";\nimport { useScrollData } from \"scroll-data-hook\";\nimport debounce from \"debounce\";\nimport { Link } from \"gatsby\";\nimport { useScrollRestoration } from \"gatsby\";\nimport { Scrollama, Step } from \"react-scrollama\";\nimport { graphql } from \"gatsby\";\nimport \"../styles.css\";\nimport { isBrowser } from \"../utils/staticRendering\";\nimport { scatterScrollingtextSwarm } from \"../utils/childhoodDiaryUtils\";\nimport { formatDataFunct } from \"../utils/childhoodDiaryUtils\";\n// import * as Scroll from 'react-scroll';\n\n// const ScrollSwarmPageDrawing = () => {\n//   return(\n//     <ScrollSwarmDrawing/>\n//   )\n// }\n\nconst ScrollSwarmPageDrawing = ({ data }) => {\n  const diaryRawData = data.allDataCsv.edges[0].node.items;\n\n  const [currentSelectedTime, setCurrentSelectedTime] = useState(null);\n  const [pixelRatio, setPixelRatio] = useState(\n    isBrowser() ? window.devicePixelRatio : 0\n  );\n  const [currentWidth, setCurrentWidth] = useState(\n    isBrowser() ? window.innerWidth : 0\n  );\n  const [currentHeight, setCurrentHeight] = useState(\n    isBrowser() ? window.innerHeight : 0\n  );\n\n  const onStepEnter = (stepdata, index) => {\n    setCurrentSelectedTime(stepdata.data);\n  };\n\n  const generateOffset = (stepdata, index) => {\n    console.log(\"OFFSET\", stepdata)\n    return 1\n  };\n\n\n  function onStepProgress  (data, index)  {\n    console.log(\"STEPDATA\", data)\n    // window.scrollTo({\n    //   top: stepdata.element.offsetTop - currentHeight/2,\n    //   behavior: 'smooth'\n    // });\n  };\n\n  const scrollOrder = [\"year\", \"month\", \"week\"];\n\n  // const [elRefs, setElRefs] = useState([]);\n\n  const stepRefs = useRef([]);\n\n  // console.log(Object.keys(stepRefs).length != scrollOrder.length)\n    stepRefs.current = scrollOrder.map((element, i) => (stepRefs.current[i] ?? createRef()));\n\n\n\n  React.useEffect(() => {\n\n\n    if (isBrowser()) {\n      setCurrentWidth(window.innerWidth);\n      setCurrentHeight(window.innerHeight);\n      setPixelRatio(window.devicePixelRatio);\n      window.onresize = function () {\n        setCurrentWidth(window.innerWidth);\n        setCurrentHeight(window.innerHeight);\n        setPixelRatio(window.devicePixelRatio);\n      };\n    }\n  }, [currentWidth, pixelRatio]);\n\n\n\n  if (isBrowser() === false) {\n    return <></>;\n  }\n\n\n  return (\n    <div className=\"scrollySwarmContainerDrawing\">\n      <div>\n\n        <ScrollSwarmDrawing\n          className={\"staticGraphicContainer scrollySwarmContainerDrawing\"}\n          height={currentHeight * 0.95}\n          width={currentWidth * 0.6}\n          particles={formatDataFunct(diaryRawData)}\n          useScrollData={useScrollData}\n          dateSelection={\n            scatterScrollingtextSwarm(currentSelectedTime).date_selection\n          }\n          valueSelection=\"entry_word_count\"\n          stepIndex={currentSelectedTime}\n          margin={45}\n          marginLeft={currentWidth * 0.1}\n          marginTop={currentHeight * 0.7}\n          pixelRatio={pixelRatio}\n        />\n        <div className=\"scrollingTextContainer darkModeScrollingTitle\">\n        {/* {scrollOrder.map((selectedTime, i) => (\n            <div ref={stepRefs.current[i]}></div>\n          ))} */}\n          <Scrollama threshold={1} offset={.5} onStepEnter={onStepEnter} debug={false}>\n\n          {scrollOrder.map((selectedTime, i) => (\n              <Step data={selectedTime}>\n                <div\n                  key={i}\n                  ref={stepRefs.current[i]}\n                  style={{\n                    opacity: currentSelectedTime === selectedTime ? 1 : .5,\n                  }}\n                  class=\"textStep scrollySwarmTextStep\"\n                >\n                  <div id={currentSelectedTime + i}    style={{\n                    opacity: currentSelectedTime === selectedTime ? 1 : 1,\n                  }} className=\"scrollToSelection\" ref={stepRefs.current[i]}> {scatterScrollingtextSwarm(selectedTime).title}</div>\n\n                </div>\n              </Step>\n            ))}\n          </Scrollama>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const query = graphql`\n  query ScrollSwarmPageDrawing {\n    allDataCsv {\n      edges {\n        node {\n          items {\n            date\n            formatted_date\n            entry_word_count\n            quarter\n          }\n        }\n      }\n    }\n  }\n`;\n\nexport default ScrollSwarmPageDrawing;\n"],"names":["diaryRawData","data","allDataCsv","edges","node","items","useState","currentSelectedTime","setCurrentSelectedTime","isBrowser","window","devicePixelRatio","pixelRatio","setPixelRatio","innerWidth","currentWidth","setCurrentWidth","innerHeight","currentHeight","setCurrentHeight","scrollOrder","stepRefs","useRef","current","map","element","i","createRef","React","onresize","className","height","width","particles","formatDataFunct","useScrollData","dateSelection","scatterScrollingtextSwarm","date_selection","valueSelection","stepIndex","margin","marginLeft","marginTop","threshold","offset","onStepEnter","stepdata","index","debug","selectedTime","key","ref","style","opacity","class","id","title"],"sourceRoot":""}