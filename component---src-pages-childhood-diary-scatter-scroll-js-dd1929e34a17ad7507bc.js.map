{"version":3,"file":"component---src-pages-childhood-diary-scatter-scroll-js-dd1929e34a17ad7507bc.js","mappings":"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","sources":["webpack://visualization-sketches/./src/components/CanvasD3Scatter/index.js","webpack://visualization-sketches/./src/pages/childhood-diary-scatter-scroll.js"],"sourcesContent":["// To fix canvas blurryness I used this: https://stackoverflow.com/questions/48961797/canvas-circle-looks-blurry\nimport { useEffect, useRef } from \"react\";\nimport { Delaunay } from \"d3-delaunay\";\nimport * as d3 from \"d3\";\nimport React from \"react\";\nimport { gsap } from \"gsap\";\nimport { isBrowser } from \"../../utils/staticRendering\";\nimport beeswarm from \"../CanvasBeeswarm\"\nimport { select } from \"d3\";\n\nconst Veroni = (props) => {\n  // const [pixelRatio, setPixelRatio] = useState(2);\n\n  const pixelRatio = props.pixelRatio;\n\n  const destinationParticles = [];\n  const originParticles = [];\n  let height = props.height;\n  let width = props.width;\n  let margin = props.margin;\n  let marginLeft = props.marginLeft;\n  let marginTop = props.marginTop;\n  let particles = props.particles;\n  let ref = useRef();\n  let highlightRef = useRef();\n  let axisRef = useRef();\n  const radius = 8;\n  ////MOVE TO HOOKS\n  const usePrevious = (value, defaultRef) => {\n    const ref = useRef(defaultRef);\n    useEffect(() => {\n      ref.current = value;\n    });\n    return ref.current;\n  };\n\n  const prevDate = usePrevious(props.dateSelection, \"year\");\n\n  let xScale = (dateElem, dateSelection) =>\n    d3\n      .scaleLinear()\n      .domain(d3.extent(particles, (d) => d[dateSelection]))\n      .range([marginLeft, width - margin]);\n\n  let yScale = d3\n    .scaleLinear()\n    .domain(d3.extent(particles, (d) => d[props.valueSelection]))\n    .range([height - margin, marginTop])\n    .nice();\n\n\n\n   let dataForDotPlot = d3\n    .bin()\n    .value((d) => d.x)\n    .thresholds(20);\n\n\n//************************************************************\n// ***** ClusterForceScales\n// ***********************************************************\n\n\n    let xScaleBee =\n    d3.scaleOrdinal()\n    .domain(d3.extent(particles, (d) => d[props.dateSelection]))\n    .range([100, 200, 300, 400, 500, 600, 7]);\n    // let yScaleBee = d3\n    // .scaleLinear().domain(d3.extent(particles.map((d) => + d[props.valueSelection])))\n    // .range([height - 50, 50]); // using 50 just to provide some margin at the top and bottom\n//************************************************************\n// ***** End ClusterForceScales\n// ***********************************************************\n\n  const animatedParticles = () =>\n    props.particles.map((d) => {\n      destinationParticles.push({\n        x: xScale(d[props.dateSelection], props.dateSelection)(\n          d[props.dateSelection],\n          props.dateSelection\n        ),\n        y: yScale(d[props.valueSelection]),\n        id: d.id,\n      });\n      originParticles.push({\n        x: xScale(d[prevDate], prevDate)(d[prevDate], prevDate),\n        y: yScale(d[props.valueSelection]),\n        id: d.id,\n      });\n    });\n\n\n\n\n  const tooltip = isBrowser() && d3.select(\"#tooltipDiv\")\n    .style(\"background-color\", \"white\")\n    .style(\"border\", \"1px solid\")\n    .style(\"border-radius\", \"2px\")\n    .style(\n      \"box-shadow\",\n      \"0 3px 6px rgba(0, 0, 0, 0.3), 0 3px 6px rgba(0, 0, 0, 0.4)\"\n    )\n    .style(\"opacity\", 0)\n    .style(\"padding\", \"10px\");\n\n\n\n  function showTooltip(tooltipX, tooltipY, tooltipZ, xScalei, yScalei) {\n    isBrowser() &&\n    tooltip\n      .style(\"opacity\", 0.7)\n      .style(\"display\", \"block\")\n      .style(\"top\", yScalei + \"px\")\n      .style(\"left\", xScalei + 15 + \"px\")\n      .style(\"z-index\", 5)\n      .html(\n        `<div>word_count: <b>${tooltipY}</b></div><div>${props.dateSelection}: <b>${tooltipX}</b></div>  <div></div>`\n      );\n  }\n\n  const delaunay = (dateString, x, y) =>\n    Delaunay.from(\n      particles.map((d) => [\n        xScale(d[props.dateSelection], props.dateSelection)(\n          d[props.dateSelection],\n          props.dateSelection\n        ),\n        yScale(d[props.valueSelection]),\n      ])\n    );\n\n  const xAxisScale = d3\n    .scaleSequential()\n    .domain(d3.extent(particles, (d) => d[props.dateSelection]))\n    .range([marginLeft, width - margin]);\n\n  const xAxis = d3\n    .axisBottom(xAxisScale)\n    .ticks(5)\n    .tickFormat((d) => `${d}`);\n\n\n\n  animatedParticles();\n  let yScaleBee = d3\n  .scaleLinear()\n  .domain(d3.extent(destinationParticles, (d) => d.y))\n  .range([0, radius])\n  .nice();\n\n  useEffect(() => {\n\n\n//************************************************************\n// ***** Scale Canvas and prep\n// ***********************************************************\n    const canvas = ref.current;\n    const context = canvas.getContext(\"2d\");\n    context.scale(pixelRatio, pixelRatio);\n    context.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n    context.globalAlpha = .4;\n//************************************************************\n// ***** End Scale Canvas and prep\n// ***********************************************************\n\n\n    const update = () => {\n      context.fillStyle = \"rgb(226, 99, 255)\";\n      context.strokeStyle = \"rgb(226, 99, 255)\";\n\n\n      const animation = ()=> gsap.fromTo(\n        originParticles,\n        {\n          x: (index) => originParticles[index].x,\n          y: (index) => originParticles[index].y,\n\n        },\n        {\n          x: (index) => destinationParticles[index].x,\n          y: (index) => destinationParticles[index].y,\n          // ease: \"power.3.out\",\n          duration: .5,\n\n\n          // Documentation: https://greensock.com/docs/v3/Staggers\n          ease: \"strong.inOut\",\n          // runBackwards: true,\n          onUpdate: animate,\n\n          stagger: {\n            each: .0005,\n            from: \"random\",\n          }\n\n        }\n      );\n\n     animation()\n\n\n\n      function animate() {\n        context.restore()\n\n        context.clearRect(0, 0, width, height);\n\n        d3.select(axisRef.current).call(xAxis).transition();\n        context.beginPath();\n        originParticles.map(\n          (d, i) => (\n            context.beginPath(),\n            context.arc(d.x, d.y, radius, 0, 2 * Math.PI),\n            // context.stroke()\n            context.fill()\n          )\n        );\n      }\n\n\n      // cy={-8 * i}\n\n//************************************************************\n// *****  clusterforce experiment\n// ***********************************************************\n\nfunction animateForce() {\n\n  context.clearRect(0, 0, width, height);\n\n  // d3.select(axisRef.current).call(xAxis).transition();\n  context.save()\n  context.beginPath();\n  originParticles.map(\n    (d) => (\n      context.beginPath(),\n      context.arc(d.x, d.y, yScaleBee(d.y), 0, 2 * Math.PI),\n      // context.stroke(),\n      context.fill()\n    ),\n  );\n}\n\n      const runSimulation=()=> {\n        // newNodes = nodes.map(({x0, y0, ...rest}) =>({x: x0, y: y0, ...rest}));\n        d3.forceSimulation(originParticles)\n          .force(\"x\", d3.forceX().x(d => xScaleBee(d.x)).strength(2))\n          // .force(\"y\", d3.forceY().y(d=> d.y).strength(0))\n\n          .force(\"collide\",\n          d3.forceManyBody().strength(.1))\n          .force('collision', d3.forceCollide().radius(d => yScaleBee(d.y + (d.y * .3)))\n          .strength(1))\n          .on(\"tick\", animateForce)\n      }\n\n\n       props.dateSelection===\"week\" && runSimulation()\n\n//************************************************************\n//***** End Functioning clusterforce experiment\n//************************************************************\n\n\n    };\n\n\n\n\n\n    onscroll = (event) => {\n\n      pointHoverOut();\n    };\n\n    const pointHoverIn = (hoverActive) => {\n      let xSelection = xScale(\n        hoverActive[props.dateSelection],\n        props.dateSelection\n      )(hoverActive[props.dateSelection], props.dateSelection);\n      let ySelection = yScale(\n        hoverActive[props.valueSelection],\n        props.valueSelection\n      );\n      d3.select(highlightRef.current)\n        .attr(\"r\", radius)\n        .attr(\"cx\", xSelection)\n        .attr(\"cy\", ySelection)\n        .attr(\"fill\", \"rgba(255,255,255,.7)\")\n        // .attr(\"stroke\", \"rgba(255,255,255, 1)\");\n    };\n\n    const pointHoverOut = () => {\n      d3.select(highlightRef.current).attr(\"r\", 0);\n    };\n\n    function hideTooltip(hoverInactive) {\n      isBrowser && tooltip.style(\"display\", \"none\");\n      isBrowser && tooltip.style(\"opacity\", \"0\");\n\n    }\n\n    onmousemove = (event) => {\n      event.preventDefault();\n      const pageYoffset = isBrowser() ? window.pageYOffset : 0\n      let mousePoint = d3.pointer(event, this);\n      let x = mousePoint[0];\n      let y = mousePoint[1] - [pageYoffset];\n      let heightCond = x < width;\n      let index = delaunay(props.dateSelection).find(x, y);\n      let indexObj = particles[index];\n      let tooltipX = indexObj[props.dateSelection];\n      let tooltipY = indexObj[props.valueSelection];\n      let tooltipZ = indexObj[props.valueSelection];\n\n      heightCond\n        ? showTooltip(\n            tooltipX,\n            tooltipY,\n            tooltipZ,\n            xScale(tooltipX, props.dateSelection)(\n              tooltipX,\n              props.dateSelection\n            ),\n            yScale(tooltipY)\n          )\n        : hideTooltip(indexObj);\n\n      heightCond ? pointHoverIn(indexObj) : pointHoverOut(indexObj);\n    };\n\n    update();\n\n  }, [props.dateSelection, props.width, props.height, props.pixelRatio]);\n\n  if (isBrowser()===false) {\n    return <></>;\n  }\n  return (\n    <div className=\"canvasStickyChartContainer\">\n\n      <div\n        id=\"tooltipDiv\"\n        className=\"tooltipDiv\"\n      />\n\n      <svg className=\"canvasStickyPointHighlight\" width={width} height={height}>\n        <circle\n          r={0}\n          className=\"highlightCircle\"\n          ref={highlightRef}\n        ></circle>\n      </svg>\n    <canvas\n        className={\"canvasStickyChart\"}\n        style={{\n          width: props.width  + \"px\",\n          height: props.height + \"px\",\n        }}\n        ref={ref}\n        particles={props.particles}\n        stroke={props.stroke}\n        width={props.width * props.pixelRatio}\n        height={props.height * props.pixelRatio}\n        useScrollData={props.useScrollData}\n        dateSelection={props.dateSelection}\n        valueSelection={props.valueSelection}\n        margin={props.margin}\n      />\n      <svg style={{top: props.height - 1}}className=\"canvasStickyChartAxis\">\n        <g className=\"darkModeAxis\" ref={axisRef}></g>\n      </svg>\n    </div>\n  );\n};\n\nexport default Veroni;\n","import React, { useState } from \"react\";\nimport CanvasD3Scatter from \"../components/CanvasD3Scatter\";\nimport { useScrollData } from \"scroll-data-hook\";\nimport debounce from \"debounce\";\nimport { Scrollama, Step } from \"react-scrollama\";\nimport { graphql } from \"gatsby\";\nimport \"../styles.css\";\nimport { isBrowser } from \"../utils/staticRendering\";\nimport { scatterScrollingtext } from \"../utils/childhoodDiaryUtils\";\nimport { formatDataFunct } from \"../utils/childhoodDiaryUtils\";\n// import * as Scroll from 'react-scroll';\n\nconst ChildhoodDiary = ({ data }) => {\n  const diaryRawData = data.allDataCsv.edges[0].node.items;\n  const yScrollSpeed = useScrollData().speed.y;\n  const [currentStepIndex, setCurrentStepIndex] = useState(0);\n  const [upDown, setUpDown] = useState(\"down\");\n  const [pixelRatio, setPixelRatio] = useState(\n    isBrowser() ? window.devicePixelRatio : 0\n  );\n  const [currentWidth, setCurrentWidth] = useState(\n    isBrowser() ? window.innerWidth : 0\n  );\n  const [currentHeight, setCurrentHeight] = useState(\n    isBrowser() ? window.innerHeight : 0\n  );\n  const onStepEnter = (stepdata) => {\n    setCurrentStepIndex(stepdata.data);\n    setUpDown(stepdata.direction);\n  };\n\n  React.useEffect(() => {\n    if (isBrowser()) {\n      setCurrentWidth(window.innerWidth);\n      setCurrentHeight(window.innerHeight);\n      setPixelRatio(window.devicePixelRatio);\n      window.onresize = function (event) {\n        setCurrentWidth(window.innerWidth);\n        setCurrentHeight(window.innerHeight);\n        setPixelRatio(window.devicePixelRatio);\n      };\n    }\n  }, [currentWidth, pixelRatio]);\n\n  if (isBrowser() === false) {\n    return <></>;\n  }\n\n  return (\n    <div>\n      <div>\n        <CanvasD3Scatter\n          className={\"staticGraphicContainer\"}\n          height={currentHeight * 0.95}\n          width={currentWidth * 0.6}\n          particles={formatDataFunct(diaryRawData)}\n          useScrollData={useScrollData}\n          dateSelection={scatterScrollingtext(currentStepIndex).date_selection}\n          valueSelection=\"entry_word_count\"\n          stepIndex={currentStepIndex}\n          margin={10}\n          marginLeft={currentWidth * 0.1}\n          marginTop={currentHeight * 0.7}\n          pixelRatio={pixelRatio}\n        />\n\n        <div className=\"scrollingTextContainer darkModeScrollingTitle\">\n          <Scrollama\n            offset={.5}\n            onStepEnter={debounce(onStepEnter, 150)}\n            debug={false}\n          >\n            {[0, 1, 2, 3].map((_, stepIndex) => (\n              <Step data={stepIndex} key={stepIndex}>\n                <div\n                  style={{ opacity: currentStepIndex === stepIndex ? 1 : 0.2 }}\n                  class=\"textStep\"\n                >\n                  {scatterScrollingtext(stepIndex).title}\n                </div>\n              </Step>\n            ))}\n          </Scrollama>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const query = graphql`\n  query ChildhoodDiaryQuery {\n    allDataCsv {\n      edges {\n        node {\n          items {\n            date\n            formatted_date\n            entry_word_count\n            quarter\n          }\n        }\n      }\n    }\n  }\n`;\n\nexport default ChildhoodDiary;\n"],"names":["props","pixelRatio","destinationParticles","originParticles","height","width","margin","marginLeft","marginTop","particles","ref","useRef","highlightRef","axisRef","prevDate","value","defaultRef","useEffect","current","usePrevious","dateSelection","xScale","dateElem","d3","domain","d","range","yScale","valueSelection","nice","xScaleBee","x","thresholds","tooltip","isBrowser","style","xAxisScale","xAxis","ticks","tickFormat","map","push","y","id","yScaleBee","context","getContext","scale","setTransform","globalAlpha","onscroll","event","pointHoverOut","attr","onmousemove","preventDefault","hoverActive","xSelection","ySelection","pageYoffset","window","pageYOffset","mousePoint","heightCond","index","Delaunay","find","indexObj","tooltipX","tooltipY","tooltipZ","xScalei","yScalei","html","showTooltip","fillStyle","strokeStyle","animate","restore","clearRect","call","transition","beginPath","i","arc","Math","PI","fill","animateForce","save","gsap","duration","ease","onUpdate","stagger","each","from","force","strength","radius","on","update","className","r","stroke","useScrollData","top","diaryRawData","data","allDataCsv","edges","node","items","speed","useState","currentStepIndex","setCurrentStepIndex","setUpDown","devicePixelRatio","setPixelRatio","innerWidth","currentWidth","setCurrentWidth","innerHeight","currentHeight","setCurrentHeight","React","onresize","CanvasD3Scatter","formatDataFunct","scatterScrollingtext","date_selection","stepIndex","offset","onStepEnter","debounce","stepdata","direction","debug","_","key","opacity","class","title"],"sourceRoot":""}